<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/img/site.webmanifest">
<title>Stuff I Just Found Out</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>





<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="/css/notebook_preset.css">
<link rel="stylesheet" href="/css/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration --></head>
<body>
<div class="panel-background">
<div class="panel-left"></div>
<div class="panel-main">

    <div class="header">
        <h1 id="title">Stuff I Just Found Out</h1>
        <p id="subtitle">A science blog with all the maths put back in.</p>
    </div> 
    <!-- Top navigation -->
    <div class="topnav">

        <!-- Centered link -->
        <div class="topnav-centered"><div>
        <a href="./index.html">Home</a>
        <a href="./about.html">About</a>
        <a href="./topics.html">Topics</a>
        <a href="./bookmarks.html">Bookmarks</a></div>
        </div>
    
    
        <!-- Right-aligned links -->
        <div class="topnav-right">
        <a href=""></a>
        </div>
    
    </div> 
    
    <div class="content">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Secret-Santa-Problem">Secret Santa Problem<a class="anchor-link" href="#Secret-Santa-Problem">&#182;</a></h1><h3 id="21-Sept.-2019">21 Sept. 2019<a class="anchor-link" href="#21-Sept.-2019">&#182;</a></h3><p>In the UK, around Christmas time, lots of schools and offices play a game called "Secret Santa". In this game, each person writes their name on a piece of paper, and puts that piece of paper into a hat. Then, everyone in the office/ class will draw a name from the hat (without replacing it), and will buy that person a Christmas present. Say there are $n$ people in the office, what is the chance there being some three people who form a "triangle" i.e. person 1 ends up buying for person 2, person 2  buys a present for person 3, and person 3 for person 1? More generally, what is the chance of a $k$-cycle being formed for any $k$? (A $k$-cycle means a "circle" of $k$ people, each buying a present for the next and the last person buying a present for the first, e.g. a 2-cycle would be when person A and person B (unknowingly) get allocated each other and are just swapping gifts, and a 1-cycle would be a personing getting allocated themselves, and then (sadly) buying their own gift. Of course, $k$ must be an integer greater than 0 and less than or equal to $n$.) If you use an online Secret Santa pairing generator then this the algorithm it uses should make sure to avoid the kind of situation where anyone has to buy themselves a gift.</p>
<p>This question was asked by someone in my office, and it is surprisingly difficult to answer! In fact, this question is an extension to the <em>Bernoulli Letter problem</em>, which is a fairly well-known puzzle, where a clumsy office clerk has randomly put all the letters on his desk into the named envelopes at random - and now wants to know the probability that none of the letters will get to the correct person.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Problem-Statement"><strong>Problem Statement</strong><a class="anchor-link" href="#Problem-Statement">&#182;</a></h3><p>There are $n$ people, labelled $a_1, ... a_n$. From basic combinatorics, we know that there are $n!$ permutations of these $n$ people (a <em>permutation</em> is just an assignment from this set $[n] =\{ a_1, ..., a_n \}$ to itself, such that no two elements are assigned the same target element; this kind of assignment is called <em>bijective</em>).</p>
<p>We can write any permutation $\pi$ using <em>disjoint cycle notation</em>, which I am giving three examples of here, for permutations on the set $[5]$, the set of 5 elements $\{1,2,3,4,5\}$:</p>
<ul>
<li><p>$\pi = (1 2 3 4 5)$, this assigns 1 to 2, 2 to 3, 3 to 4, 4 to 5, 5 to 1 (wraps around)</p>
</li>
<li><p>$\pi = (1)(2)(3)(4)(5)$, this assigns 1 to 1, 2 to 2, 3 to 3, 4 to 4, 5 to 5 (each element assigned to itself)</p>
</li>
<li><p>$\pi = (1 3)(2 4 5)$, this assigns 1 to 3 and 3 to 1, 2 to 4, 4 to 5 and 5 to 2</p>
</li>
</ul>
<p>A couple of obvious points:</p>
<ul>
<li><p>every permutation can be written using this disjoint cycle notation, and apart from the order of the cycles, each permutation can only be represented in one way.</p>
</li>
<li><p>$k$-cycles in the disjoint cycle notation are exactly what we mean by $k$-cycles of the permutation, i.e. in the third example above, $(1 3)$ is a 2-cycle where 1 maps to 3 and 3 maps to 1, $(2 4 5)$ is a 3-cycle where 2 maps to 4, 4 maps to 5, and 5 maps back to 2.</p>
</li>
</ul>
<p>So we can state the Secret Santa problem more precisely:</p>
<p><strong>given a randomly chosen permutation $\pi$ (chosen uniformly at random from the $n!$ available options) what is the probability that $\pi$ contains a $k$-cycle when written in disjoint cycle notation?</strong></p>
<h3 id="Simulations"><strong>Simulations</strong><a class="anchor-link" href="#Simulations">&#182;</a></h3><p>If we notice a trick then we can find a recursive way to solve this problem exactly, and it also helps us simulate this problem. The trick is this:</p>
<ul>
<li>if you start off with $n$ elements, and starting with element $1$, assign it element $a_1$ uniformly at random, and then for $a_1$ assign that an element $a_2$ uniformly at random from the remaining $n-1$ elements, and so on, until after some number of steps (say $k$ many steps), $a_k$ is assigned back to $1$, then you will have created a $k$-cycle. The probability of generating a $k$-cycle in this way is $1/n$, i.e. <strong>when you start off with $n$ elements and create a cycle, the cycle length $k$ is equally likely to be any of the $n$ different options from 1 to $n$.</strong></li>
</ul>
<p>(Why is this true? We can see that this is true with a simple calculation. A $k$-cycle can appear in this way only if:</p>
<ul>
<li>Element 1 is assigned any element other than itself - call it $a_1$ (probability $(n-1)/n$ of this happening). </li>
<li>Element $a_1$ is assigned $a_2$, which can be any element other than element 1 (it can't be assigned itself, because $a_1$ was already assigned to element 1. The probability of this happening is $(n-2)/(n-1)$. </li>
<li>Element $a_2$ is assigned $a_3$, which can be any element other than element 1 (it can't be assigned itself, or to $a_1$ because $a_1$ was already assigned to element 1 and $a_2$ was assigned to $a_1$. The probability of this happening is $(n-3)/(n-2)$. </li>
<li>... and so on... until we get down to $n-k$ elements. At the $i$th stage in this process, the probability of the process being able to continue is $(n-i+1)/(n-i)$. </li>
<li>At the $k$th stage, to get a $k$-cycle, element $a_k$ <em>must</em> get assigned back to 1 (to close the loop). This has a chance of $1/(n-k)$. </li>
<li>Each of these stages has been independant, so to get the total probability, we can multiply the probability from each stage. If we do this we get:</li>
</ul>
$$ \frac{n-1}{n} \times \frac{n-2}{n-1} \times \frac{n-3}{n-2} \times ... \times \frac{1}{n-k} $$<p>In this expression, the numerator of each term cancels with the denominator of the next term, leaving just $1/n$, Q.E.D..)</p>
<p>This is helpful, because it means that to simulate this problem we don't have to both creating any permuations and computing their cycle types. Instead, we can use this algorithm;</p>
<ol>
<li>Start off with $n$, the total number of elements. </li>
<li>Pick a number less than or equal to $n$, (call it $k$) uniformly at random. (This represents the first cycle type.)</li>
<li>Set $n \rightarrow n - k$ and go back to step 2, until you get to $n = 0$. </li>
</ol>
<p>The above steps 1 to 3 have generated a cycle type - now just repeat this say a thousand or a million times and look at the distribution of cycle types you end up with.</p>
<h3 id="Empirical-Solution"><strong>Empirical Solution</strong><a class="anchor-link" href="#Empirical-Solution">&#182;</a></h3><p>If you do the simulations, you get a distribution of cycle types that looks like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_people</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">occurrences</span> <span class="o">=</span> <span class="n">simulate_and_count</span><span class="p">(</span><span class="n">n_people</span><span class="p">,</span> <span class="n">N_simulations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_people</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">occurrences</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probability that a $k$-cycle exists in a random permutation of 40 elements&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prob(k-cycle)&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;Prob(k-cycle)&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcQAAAEaCAYAAACPaydAAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nO3de5gkdXno8e/rclPWoASzKrsI6mpCXLnsCMlR4yxisopCTEiCLkRODq5J2GDijcV40BBzQi6KmqBmAwhHxdFoJJu4OZhE5jFPLrKsEnFByIrLZZWLF9BBLi6+54+qgdre7unume7q2pnv53nmma6qX1W9/av69dv1q0tHZiJJ0kL3mFEHIElSE5gQJUnChChJEmBClCQJMCFKkgSYECVJAkyIkiQBJkRJkoARJMSI2B4Rxw9j3ojYGhHjrWWr44dhLu9pGCLitog4agTrrb0ehr1t61rHsEXEpRHxzlHHMR+MYn+IiGdHxLUR8f2IOKvOdbeJpVGfd4PUU0IsK+D+iJiKiDvLxrV42MH1KzN/OjMnu40fZlJuwPKeCDwFuGFQy2yyTtu81Vzqudd1qPn63Q/alR/R/vAW4KrMfHxmvq9ToYhYHhEPRMRHWsYfGBGfjoj7IuKWiHj10COu0aA+R/s5QnxFZi4GjgbGgLe1CWqvuQakOVsBbMvMB0YdiGbHdlSwHnbxNGBrD+UuBDZ3GP8QsARYA3wgIn56cOHNE5nZ9Q/YDhxfGf4z4B8q084Gvgw8COwF/BQwCdxDsRFPbFnWOcD1wHeBDwH7VaavB74GfL8s88o+5n0kzhlefxj4EXA/MFXG/qmW9/s+4L1t6qF13rdUlv+msg7uBT7ey3vqtLyWdXasjw7bah3wyfL144DLgb8FFrcpu6ycdjfwbeAvgTd3q49287Wp56cCnyrLfB04q0vcbcsDzwC+AxxdKXc3MN5h3zwb2FHW143Ai9vVc7tyvez/3bb1bLcd7dvRjPPPFAtwFPDFct6PAxPAOyvzdmujby6Xex9wMcUH6T+Wy/tn4Ild3kvbdtptv+hQDz3HAyTwzMryLp1+3+32g9m0z5b9oVs99rSvzLQs4HPAw8ADZRzP6jD/KcAngHcAH6mM358iGT6rMu7DwPn9tMUO7aFj2X62Wx/r3a0+Z9hOPbfxR9bRrUCbClhWbqw/rEy7thz/WGBvYBvwVmAf4LgyoGdXyn+lLH8g8G/s2lB/payYxwC/VlbkU3qctxpn29dtpj2lXMcTyuG9gLuAld3qomXc1WXcB1J0V/5mH+/p+BnqvuO8Hcr/FfB24DDgS+XraFNuEfBfwAUUDWY/4AXd6qPTfNX3Usa6BTi33AeeDtwM/EKHmGcsD7yW4oPqccCVwJ932JbPBm4DnloOHwo8o59yPez/M27r2W47WtpRL/N3iqWsw1uA36NojycDP+TRxNBLG/1Pig+vg8vt/0WKJLsfxQf027vU127ttJf9okM99BwPMyTEGdpvX+2TR/fzXuqx132l27ImgTNmqPMfA24ClrJ7QjwK+EFL+TcBf99vW+ynnfe53Xpdb9v6bN1O9NnGH5mvW4HKyqYovrncAryfXXfW36iUfSFwB/CYyriPAe+olK8mi5cBX5th3dcCJ/UyL7NIiOXwPwKvLV+/HLi+lw/HlnGnVob/FPhgH++pY0Kcad4O0/8D+GC53JnK/SzFN7G92kzrWB9d5ttO0VCOBW5tmXYO8KEOsXQtD2wErqP4drhvh23+TIpGdzywd6ftNlO5btu8323d67ajpR31Mn+nWICfA75B5YsQ8O88mhB7aaNrKtM+BXygMvw7wBVd6mu3dtrjdt6tHvqJh1kkxJnquV15Ht3Pe6nHnvaVHpY1ycwJ8b3A2eXrd7BrQnwhcEdL+dcCk7Nsi9Pvf8ayfW63Xtfbtj5btxN9tvHpv37OIf5iZj4hM5+Wmb+dmfdXpt1Wef1U4LbM/FFl3C0U3xDalb+lnAeAiPj18mqqeyLiHuA5wEG9zDsHlwGnlq9PpTgE79cdldc/AB656KiH99RRP/NGRJTTX0mx4/1dZdqa8qKoqYj4R4pv4Ldk5s42i5qpPmaab9rTgKdOx1zG/VaKb4qzLf/X5Xv7i8x8sN1CMnMb8LsUHwh3RcREROy2f/RabgYdt3XVLLZ7dd/udf52sTwV2JHlJ0PplsrrXtronZXX97cZ7nZRXbt22ut+cRu7m2s8Hc2hffZSjz3tKz0uq1P8R1J88F/QocgUxRFk1Y9RHIG26qft9lK21+3W63p7qs/ZtvFB3XZRbXjfAJZFRHXZh1D05U5b1jLtGwAR8TSKD751wI9n5hMoul6i27xziBfgCuC5EfEciiOij/Yx74x6eE8dl9djfVQdVv4/HnhjRIw9EnTmRzNzcfn3UooPnUM6XLgwU33MNF+1zNfLL1DTf4/PzJfNpnx5RfN7KM5BvCMiDuy04sy8PDNfQNHAEviT6Uk9lhuIWWy7XWKc5fzTvgkcXH5BmnZI5XUvbXSu2rXTXveLvtpYix9QdK1Pe/JMy55L+2Sw9TiXZY1TdAneGhF3UHSH/nJEfLGcfhOwV0Qsr8xzBO0v0umn7fbbzmcy12Xttp1m08aHcR/iFyh2yrdExN7l/TqvoDipP+3MiFhafrD9PsXJUSjOSSVFlxwR8T8pvq3Rw7z9uJOijxqALK7I/CTFBShXZ+atvc7bg27vaabl9VIfVc8FvpyZ1wFrgU9HxFM6lL2a4oPz/IjYPyL2i4jnQ9f66DhfS5nvR8TZEfHYiFgUEc+JiOfNEMtM5d8LXJOZZwCfoegW3E0U92odFxH7UlyAcD/FyXao1HOXcoPS77Yb5Pz/AewEzirb4C8Bx1Sm99JG56pdO+13v5iNa4FXl8teDbyoZXpre5tL+xxkPc5lWRsoLj47svz7IEU7+QWAzLyP4iK488o2+3zgJNr3hPWzjQa5Pee6rF2202zb+MATYmY+RLEhXwp8i+J8469n5lcrxS4HPktx0vRrFCfcyczrgXdRNOg7KW4h+LeWVbSdt09/DLytPDR/UznusnJ93bpL283bUQ/vqePyeqyPqhUU59jIzCsoGsoVEbFfm7gepthOzwRuBW6nuKBgWtv66GG+6TIvp2icX6fYDy4CDmgX9EzlI+IkYDXwW2XxNwBHR8SaNovaFzi/nP8O4CcozkNApZ7LeDuVG4hZbLuBzV+2wV8CTqe4QvfXKD4Qq9O7tdG52q2d9rtfzNLrKd7bPRS3F1zRMn2X9jbH9jmwepzLsjLzB5l5x/QfRRfpA5l5d6XYb1Nc9HgXxbnJ38rM3Y4Q+9lGg9yeA1hW63aa6bOgo9j1NMPCFRGHAF8FnpyZ3xt1PKNmfWi2ImI7xQUg/zzqWKR++CxToOy3fwMw4Ye/9SFpYVrwT4KIiP0pukpuoeiaW9CsD0kLlV2mkiRhl6kkScAC6zI96KCD8tBDD+1a7r777mP//fcffkCz0NTYjKs/TY0LmhubcfVnkHFt2bLlW5n5pIEsrMl6faTNfPhbuXJl9uKqq67qqdwoNDU24+pPU+PKbG5sxtWfQcZFcR/wyD/Dh/1nl6kkSXgOUZIkwIQoSRJgQpQkCTAhSpIEmBAlSQJMiJIkASZESZIAE6IkScACe3TbXBy6/jNtx28//4SaI5EkDYNHiJIkYUKUJAkwIUqSBJgQJUkCTIiSJAENTogRsToiboyIbRGxvkOZX42I6yNia0RcXneMkqT5o5G3XUTEIuBC4CXA7cDmiNiYmddXyiwHzgGen5nfjYifGE20kqT5oKlHiMcA2zLz5sx8CJgATmop81rgwsz8LkBm3lVzjJKkeSQyc9Qx7CYiTgZWZ+YZ5fBpwLGZua5S5grgJuD5wCLgHZn5/9osay2wFmDJkiUrJyYmuq5/amqKxYsX7zLuuh33ti274uADentTA9IutiYwrv40NS5obmzG1Z9BxrVq1aotmTk2kIU1WCO7THu0F7AcGAeWAp+PiBWZeU+1UGZuADYAjI2N5fj4eNcFT05O0lru9E5PqlnTfXmD1C62JjCu/jQ1LmhubMbVn6bG1WRN7TLdASyrDC8tx1XdDmzMzB9m5tcpjhaX1xSfJGmeaWpC3Awsj4jDImIf4BRgY0uZKyiODomIg4BnATfXGaQkaf5oZELMzJ3AOuBK4AbgE5m5NSLOi4gTy2JXAt+OiOuBq4A3Z+a3RxOxJGlP19hziJm5CdjUMu7cyusE3lD+SZI0J408QpQkqW4mREmSMCFKkgSYECVJAkyIkiQBJkRJkgAToiRJgAlRkiTAhChJEmBClCQJMCFKkgSYECVJAkyIkiQBJkRJkgAToiRJgAlRkiTAhChJEmBClCQJMCFKkgSYECVJAkyIkiQBJkRJkgAToiRJgAlRkiSgwQkxIlZHxI0RsS0i1reZfnpE3B0R15Z/Z4wiTknS/LDXqANoJyIWARcCLwFuBzZHxMbMvL6l6Mczc13tAUqS5p2mHiEeA2zLzJsz8yFgAjhpxDFJkuaxyMxRx7CbiDgZWJ2ZZ5TDpwHHVo8GI+J04I+Bu4GbgN/LzNvaLGstsBZgyZIlKycmJrquf2pqisWLF+8y7rod97Ytu+LgA3p6T4PSLrYmMK7+NDUuaG5sxtWfQca1atWqLZk5NpCFNVgju0x79PfAxzLzwYh4HXAZcFxroczcAGwAGBsby/Hx8a4LnpycpLXc6es/07bs9jXdlzdI7WJrAuPqT1PjgubGZlz9aWpcTdbULtMdwLLK8NJy3CMy89uZ+WA5eBGwsqbYJEnzUFMT4mZgeUQcFhH7AKcAG6sFIuIplcETgRtqjE+SNM80sss0M3dGxDrgSmARcElmbo2I84BrMnMjcFZEnAjsBL4DnD6ygCVJe7xGJkSAzNwEbGoZd27l9TnAOXXHJUman5raZSpJUq1MiJIkYUKUJAkwIUqSBJgQJUkCTIiSJAEmREmSABOiJEmACVGSJMCEKEkSYEKUJAkwIUqSBJgQJUkCTIiSJAEmREmSABOiJEmACVGSJMCEKEkSYEKUJAkwIUqSBMBedawkIp4IPBW4H9iemT+qY72SJPVqaAkxIg4AzgReBewD3A3sByyJiP8E3p+ZVw1r/ZIk9WOYR4ifBP4v8MLMvKc6ISJWAqdFxNMz8+IhxiBJUk+GlhAz8yUzTNsCbBnWuiVJ6tfQL6qJwqkRcW45fEhEHNPDfKsj4saI2BYR62co98sRkRExNsi4JUkLSx1Xmb4f+FmKc4kA3wcunGmGiFhUlnkpcDjwqog4vE25xwOvB74wyIAlSQtPHQnx2Mw8E3gAIDO/S3GRzUyOAbZl5s2Z+RAwAZzUptwfAn8yvWxJkmYrMnO4K4j4AvA/gM2ZeXREPAn4bGYeNcM8JwOrM/OMcvg0isS6rlLmaOD3M/OXI2ISeFNmXtNmWWuBtQBLlixZOTEx0TXmqakpFi9evMu463bc27bsioMP6Lq8QWoXWxMYV3+aGhc0Nzbj6s8g41q1atWWzJz3p6XquA/xfcCngZ+IiD8CTgbeNpcFRsRjgHcDp3crm5kbgA0AY2NjOT4+3nX5k5OTtJY7ff1n2pbdvqb78gapXWxNYFz9aWpc0NzYjKs/TY2ryYaeEDPzoxGxBXgxEMAvZuYNXWbbASyrDC8tx017PPAcYDIiAJ4MbIyIE9sdJUqS1M0wb8w/sDJ4F/Cx6rTM/M4Ms28GlkfEYRSJ8BTg1dMTM/Ne4KDK8ibp0GUqSVIvhnmEuAVIiqNCyteUwwk8vdOMmbkzItYBVwKLgEsyc2tEnAdck5kbhxe2JGkhGuaN+YfNcf5NwKaWced2KDs+l3VJkjT0c4gR8Urgc2U3JxHxBGA8M68Y9rrrdGini27OP6HmSCRJs1HHfYhvn06GAOVzTd9ew3olSepZHQmx3Tpq+dkpSZJ6VUdCvCYi3h0Rzyj/3o0P9pYkNUwdCfF3gIeAj1M8gu0Bit9JlCSpMerounx6Znb8tQpJkpqgll+7iIirI+K3IqLeB39KktSjoSfEzHwhcCpwCLAlIi6PiI4/HixJ0ijUcYRIZt5E8UDvs4EXAe+LiK9GxC/VsX5JkroZekKMiOdGxAXADcBxwCsy86fK1xcMe/2SJPWijotq/gK4CHhrZt4/PTIzvxERc/oZKEmSBqWOhHgCcH9mPgyP/Jbhfpn5g8z8cA3rlySpqzrOIf4z8NjK8OPKcZIkNUYdCXG/zJyaHihfP66G9UqS1LM6EuJ9EXH09EBErATun6G8JEm1q+Mc4u8CfxMR36D4ceAnA79Ww3olSerZ0BNiZm6OiJ8Enl2OujEzfzjs9UqS1I+6bsz/YWZ+BTjLZChJaqJaEmLFWM3rkySpJ3UnxLtqXp8kST2p49Fth02/zszV5bjnDXu9kiT1o44jxE9FxMHTAxHxIuCSGtYrSVLP6kiIrwOuiIgnR8TLgPcBL6thvZIk9ayu2y7OAj4LPAAcn5l3D3u9kiT1Y2gJMSL+HsjKqMcB9wIXRwSZeWKX+VcD7wUWARdl5vkt038TOBN4GJgC1mbm9QN8C5KkBWSYR4h/PtsZI2IRcCHwEuB2YHNEbGxJeJdn5gfL8icC7wZWzyFeSdICNsyE+PnMzJkKRER0KHMMsC0zby7LTQAnAY8kxMz8XqX8/ux6NCpJUl+iS86a/YIjJoFPAX+XmbdWxu8DvAB4DXBVZl7aZt6TgdWZeUY5fBpwbGauayl3JvAGYB/guMz87zbLWgusBViyZMnKiYmJrrFPTU2xePHiXcZdt+PetmVXHHxAT9MHpV1sTWBc/WlqXNDc2IyrP4OMa9WqVVsyc94/WGWYR4irgd8APlbei3gPxe8iPobiApv3ZOaX5rKCzLwQuDAiXg28jSLJtpbZAGwAGBsby/Hx8a7LnZycpLXc6es/07bs9jXjPU0flHaxNYFx9aepcUFzYzOu/jQ1riYbWkLMzAeA9wPvj4i9gYOA+zPznh5m3wEsqwwvLcd1MgF8YLaxSpJU16PbVgC/ApwWEUf1UH4zsDwiDiu7WE8BNlYLRMTyyuAJwG7dpZIk9aqOR7edC1wG/DjFUeKlEfG2mebJzJ3AOuBK4AbgE5m5NSLOK68oBVgXEVsj4lqK84i7dZdKktSrOn4geA1wRNmFSkScD1wLvHOmmTJzE7CpZdy5ldevH3yokqSFqo6E+A1gP4qn1ADsy8znA+edQztdcHP+CTVHIknqZJhPqvkLinsD7wW2RsQ/lcMvAa4e1nolSZqNYR4hXlP+3wJ8ujJ+cojrlCRpVoZ528Vl06/LK0WfVQ7emJk/HNZ6JUmajaGfQ4yIcYqrTLcDASyLiNdk5ueHvW5JknpVx0U17wJ+PjNvBIiIZwEfA1bWsG5JknpSx435e08nQ4DMvAnYu4b1SpLUszqOELdExEXAR8rhNTx6wY0kSY1QR0Kc/iHfs8rhf6V4xqkkSY0x1IRY/tDvf2XmT1L8gK8kSY001HOImfkwcGNEHDLM9UiSNFd1dJk+keJJNVcD902PzMwTO88iSVK96kiI/7uGdUiSNCfDfJbpfhQX1DwTuA64uPxZJ0mSGmeY5xAvA8YokuFLKW7QlySpkYbZZXp4Zq4AiIiL8RcuJEkNNswjxEce4G1XqSSp6YZ5hHhERHyvfB3AY8vhADIzf2yI65YkqS/D/PmnRcNatiRJg1bHw70lSWq8Ou5DVBeHrv9M2/Hbzz+h5kgkaeHyCFGSJEyIkiQBJkRJkoAGJ8SIWB0RN0bEtohY32b6GyLi+oj4ckT8S0Q8bRRxSpLmh0YmxPJ3FC+keOTb4cCrIuLwlmJfAsYy87nAJ4E/rTdKSdJ80siECBwDbMvMmzPzIWACOKlaIDOvyswflIP/CSytOUZJ0jwSmTnqGHYTEScDqzPzjHL4NODYzFzXofxfAndk5jvbTFsLrAVYsmTJyomJia7rn5qaYvHixbuMu27HvW3Lrjj4gK7T5zJvL7E1gXH1p6lxQXNjM67+DDKuVatWbcnMsYEsrMH2+PsQI+JUil/VeFG76Zm5AdgAMDY2luPj412XOTk5SWu50zvdK7hmvOv0uczbS2xNYFz9aWpc0NzYjKs/TY2ryZqaEHcAyyrDS8txu4iI44HfB16UmQ/WFJskaR5q6jnEzcDyiDgsIvYBTgE2VgtExFHAXwEnZuZdI4hRkjSPNPIIMTN3RsQ64EpgEXBJZm6NiPOAazJzI/BnwGLgbyIC4NbMPHFkQQ9R9dFub1yx85EuVh/tJkmD08iECJCZm4BNLePOrbw+vvagJEnzVlO7TCVJqpUJUZIkTIiSJAEmREmSABOiJEmACVGSJMCEKEkSYEKUJAkwIUqSBJgQJUkCTIiSJAENfpapenNop99S9MHfktQXjxAlScKEKEkSYEKUJAnwHOK85zlGSeqNR4iSJGFClCQJMCFKkgSYECVJAkyIkiQBJkRJkgBvu1jwvC1DkgoeIUqSRIMTYkSsjogbI2JbRKxvM/3nIuKLEbEzIk4eRYySpPmjkQkxIhYBFwIvBQ4HXhURh7cUuxU4Hbi83ugkSfNRU88hHgNsy8ybASJiAjgJuH66QGZuL6f9aBQBSpLml8jMUcewm7ILdHVmnlEOnwYcm5nr2pS9FPiHzPxkh2WtBdYCLFmyZOXExETX9U9NTbF48eJdxl234962ZVccfEDX6XOZt3X6ksfCnfcPZ9n9xl3Vrs6awLj619TYjKs/g4xr1apVWzJzbCALa7CmHiEOTGZuADYAjI2N5fj4eNd5JicnaS13eqerMdeMd50+l3lbp79xxU7edd1eQ1l2v3FXtauzJjCu/jU1NuPqT1PjarKmJsQdwLLK8NJynBrk0JZEPZ1AvWVD0p6okRfVAJuB5RFxWETsA5wCbBxxTJKkeayRR4iZuTMi1gFXAouASzJza0ScB1yTmRsj4nnAp4EnAq+IiD/IzJ8eYdhq4U3/kvYkjUyIAJm5CdjUMu7cyuvNFF2pkiTNWWMTouY3jx4lNU1TzyFKklQrjxDVSB5BSqqbR4iSJGFClCQJsMtUe6BO3algl6qk2TMhat7xCTqSZsOEqAVnpgt2PPqUFi7PIUqShAlRkiTALlOpL93uj5zL/ZPeeymNlkeIkiThEaJUm7le/Tqbi4EGceQqLRQeIUqShEeIkpj56NWjTy0UJkRJQzWXrl6pTiZESY01myPX6elSv0yIkualuXT1dku23S6Q8vabPZMJUZJqZMJrLhOiJO1Bej2y9cH2/fO2C0mSMCFKkgSYECVJAkyIkiQBDU6IEbE6Im6MiG0Rsb7N9H0j4uPl9C9ExKH1RylJmi8amRAjYhFwIfBS4HDgVRFxeEux/wV8NzOfCVwA/Em9UUqS5pNGJkTgGGBbZt6cmQ8BE8BJLWVOAi4rX38SeHFERI0xSpLmkcjMUcewm4g4GVidmWeUw6cBx2bmukqZr5Rlbi+Hv1aW+VbLstYCa8vBZwM39hDCQcC3upYajabGZlz9aWpc0NzYjKs/g4zraZn5pAEtq7Hm/Y35mbkB2NDPPBFxTWaODSmkOWlqbMbVn6bGBc2Nzbj609S4mqypXaY7gGWV4aXluLZlImIv4ADg27VEJ0mad5qaEDcDyyPisIjYBzgF2NhSZiPwmvL1ycDnson9v5KkPUIju0wzc2dErAOuBBYBl2Tm1og4D7gmMzcCFwMfjohtwHcokuag9NXFWrOmxmZc/WlqXNDc2IyrP02Nq7EaeVGNJEl1a2qXqSRJtTIhSpKECXE33R4ZNyoRsT0irouIayPimhHHcklE3FXeCzo97sCI+KeI+O/y/xMbEtc7ImJHWW/XRsTLRhDXsoi4KiKuj4itEfH6cvxI62yGuEZaZxGxX0RcHRH/Vcb1B+X4w8rHNG4rH9u4T51xdYnt0oj4eqXOjqw7tjKORRHxpYj4h3J45HW2JzEhVvT4yLhRWpWZRzbg3qJLgdUt49YD/5KZy4F/KYfrdim7xwVwQVlvR2bmpppjAtgJvDEzDwd+Bjiz3K9GXWed4oLR1tmDwHGZeQRwJLA6In6G4vGMF5SPa/wuxeMb69YpNoA3V+rs2hHEBvB64IbKcBPqbI9hQtxVL4+MW/Ay8/MUV/ZWVR+ldxnwi7UGRce4Ri4zv5mZXyxff5/iA+tgRlxnM8Q1UlmYKgf3Lv8SOI7iMY0wun2sU2wjFxFLgROAi8rhoAF1ticxIe7qYOC2yvDtNOADopTAZyNiS/k4uqZZkpnfLF/fASwZZTAt1kXEl8su1dq7cqvKX2U5CvgCDaqzlrhgxHVWdv1dC9wF/BPwNeCezNxZFhlZ22yNLTOn6+yPyjq7ICL2HUFo7wHeAvyoHP5xGlJnewoT4p7jBZl5NEV37pkR8XOjDqiT8gEJjfjWDHwAeAZF99Y3gXeNKpCIWAx8CvjdzPxeddoo66xNXCOvs8x8ODOPpHhK1THAT9YdQyetsUXEc4BzKGJ8HnAgcHadMUXEy4G7MnNLneudb0yIu+rlkXEjkZk7yv93AZ+m+JBokjsj4ikA5f+7RhwPAJl5Z/kB9iPgrxlRvUXE3hRJ56OZ+bfl6JHXWbu4mlJnZSz3AFcBPws8oXxMIzSgbVZiW112P2dmPgh8iPrr7PnAiRGxneJUz3HAe2lYnTWdCXFXvTwyrnYRsX9EPH76NfDzwFdmnqt21UfpvQb4uxHG8ojphFN6JSOot/JczsXADZn57sqkkdZZp7hGXWcR8aSIeEL5+rHASyjOb15F8ZhGGNE+1iG2r1a+2ATFebpa6ywzz8nMpZl5KMXn1ucycw0NqLM9iU+qaVFeYv4eHn1k3B+NOCQi4ukUR4VQPG7v8lHGFREfA8Ypfl7mTuDtwBXAJ4BDgFuAX83MWi9w6RDXOEXXXwLbgddVztvVFdcLgH8FruPR8ztvpThfN7I6myGuVzHCOouI51JcALKI4kv7JzLzvLIdTFB0SX4JOLU8IqvNDLF9DngSEMC1wG9WLr6pVUSMA2/KzJc3oc72JCZESZKwy1SSJMCEKEkSYEKUJAkwIUqSBJgQJUkCTIiSJAEmREmSABOiNFIR8eKI+PCo45BkQtplDEcAAACzSURBVJRG7QiKJ4hIGjETojRaRwBfioh9y19d/z/l8zAl1Wyv7kUkDdFzKX7l4krgosz8yIjjkRYsn2UqjUj500vfoniw9+sy8z9GHJK0oNllKo3OT1H85NhO4OERxyIteCZEaXSOAP6d4vfrPhQRS0Ycj7SgmRCl0TkC+Epm3gScDXyi7EaVNAKeQ5QkCY8QJUkCTIiSJAEmREmSABOiJEmACVGSJMCEKEkSYEKUJAmA/w+3J9n8M1zwlwAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It sort of looks like it might be exponentially decreasing, so we could have a guess at the form of the answer, and try fitting a curve of the form $e^{-p}$ to this data ($p$ being the probability of there being a $k$-cycle). This doesn't work, so the next thing would be to look at a a log-log plot. However, because we are dealing with probabilities, it also makes sense to look at graphs of both $p$ and $1-p$, and it turns out that $1-p$ follows a much more obvious pattern, when graphed on a log-log plot.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">occurrences</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\log(k)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\log(1-p)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;log-log plot of $k$ against $1-p$ i.e. Prob(No k-cycle) - set size = 40&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;log-log plot of $k$ against $1-p$ i.e. Prob(No k-cycle) - set size = 40&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A nice straight line with gradient of -1! This means we can expect the final answer to look like $1 - e^{-1/x}$. 
This kind of analysis would be good enough for a physicist or engineer, but if you are thinking like a mathematician then you will want to have better proof that this hypothesis is correct.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_results</span><span class="p">():</span>
    <span class="n">n_people</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">occurrences</span> <span class="o">=</span> <span class="n">simulate_and_count</span><span class="p">(</span><span class="n">n_people</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_people</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">occurrences</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span>  <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">X</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>

<span class="n">plot_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mathematical-Solution"><strong>Mathematical Solution</strong><a class="anchor-link" href="#Mathematical-Solution">&#182;</a></h3><p>To look for a mathematical solution to this problem, the first thing to do is invent some notation. Let's write $p_k(n)$ for the probability that a randomly chosen permutation of $n$ elements contains a $k$-cycle. Earlier we had been calling this value $p$, but we need more notation than this because this probability will depend on $k$, the cycle length of interest, as well as on $n$, the total number of elements. We know from the trick we spotted earlier that when we generate a permutation, we remove some number of elements in the first cycle (call that amount $i$), which with equal likelihood will be one of 1, 2, 3, ... up to $n$. So we can write down a recursive equation for $p_k(n)$:</p>
$$p_k(n) = \frac{1}{n}  + \frac{1}{n} \sum_{i=1, i \neq n-k}^{n} p_k(n-i)$$<p>Where does equation this come from? It is just the statement of our trick, written mathematically. The probability of generating a permutation with a $k$-cycle is the sum of two factors:</p>
<ul>
<li>There is a $1/n$ chance that the first cycle generated (which we are indexing with $i$) is a $k$-cycle. </li>
<li>Otherwise, for any $i \neq k$, an $i$ cycle has been generated (with probability $1/n$) and there are $n-i$ remaining elements, from which we still need to create a $k$-cycle. The chance of generating a $k$-cycle from the remaining $n-i$ elements is by definition $p_k(n-i)$. </li>
</ul>
<p>Now we can just do some standard algebraic trickery to turn this recursive equation into nice formula. Replacing n with n-1 in the equation above, we get:</p>
$$p_k(n-1) = \frac{1}{n-1} (1 + \sum_{i=1, i\neq n-1-k}^{n-1} p_k(n-1-i))$$<p>This is exactly the same equation as before, but with $n$ replaced with $n-1$. However, if we clear the denominators in these equations and subtract one equation from the other, we can get the horrible summations to disappear, leaving only:</p>
$$np_k(n) - (n-1)p_k(n-1) = p_k(n-1-k) - p_k(n-k) + p_k(n-1)$$<p>This can be further simplified to</p>
$$n(p_k(n) - p_k(n-1)) = p_k(n-1-k) - p_k(n-k),$$<p>which looks much nicer.</p>
<p>Let's call $\delta_k(n) = p_k(n) - p_k(n-1)$ for the difference between two consecutive terms. Then, after simplifying,</p>
$$\delta(n) = \frac{-1}{n}\delta(n-k)$$<p>Furthermore, if we think about the initial conditions, then we can see that $p_k(t) = 0$ for $t&lt;k$ and $p_k(k) = 1/k$. (Why? Because you can't get a $k$-cycle if you start off with fewer than $k$ elements, and when you have exactly $k$ elements then the chance of a $k$-cycle is exactly $1/n$. So we can completely solve this equation for the deltas. We get that:</p>
$$ \delta_k(rk) = \frac{1}{r!} (-1/k)^r$$<p></p>
<p>for integer $r$, and $\delta_k(n)$ is 0 whenever $n$ is not a multiple of $k$.</p>
<p>Remember that we are defining $\delta_k$ as the difference $p_k(n) - p_k(n-1)$, so if we sum all the deltas we recover $p_k(n)$. Thus,</p>
$$p_k(n) = \sum_{i\leq n/k}\frac{1}{i!}(-1/k)^i$$<p>This is just the first few terms in the series expansion of $1 - e^{-1/k}$ (remember that $e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + ...$).</p>
<p>In full:</p>
$$p_k(n) = \frac{1}{1!}(1/k)^1 - \frac{1}{2!}(1/k)^2 + \frac{1}{3!}(1/k)^3 - \frac{1}{4!}(1/k)^4 + ...  \approx 1 - e^{-1/k}$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Follow-up-questions"><strong>Follow-up questions</strong><a class="anchor-link" href="#Follow-up-questions">&#182;</a></h3><p>There are a few obvious questions we can ask:</p>
<ul>
<li><p>What is the probability that a randomly chosen person will be in a $k$-cycle?</p>
</li>
<li><p>What is the expected number of $k$ cycles?</p>
</li>
<li><p>How do all these things behave for large $n$?</p>
</li>
</ul>
<p>I'll leave these for you to think about because these are all quite easy to answer, especially once you understand the problem we've just seen.</p>
<p>There's a different way to solve this question (which I didn't come up with) that uses the inclusion-exclusion principle! This is clever and is a more straightforward counting method, and doesn't bother messing around with all these probabilities.</p>
<p><strong>That's it! I hope you have found this interesting. Merry Xmas!</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">profile</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234321</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">brute_force_simulator</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    First creates a random permutation and then calculates the cycle types by looking through permutations. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">#list of cycle types seen so far</span>
    <span class="n">occurrences</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1">#use numpy to shuffle a permutation from 0 to n-1</span>
    <span class="n">people_permutation</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">people_permutation</span><span class="p">)</span>
    
    <span class="c1">#now compute the cycle type of the permutation</span>
    <span class="n">first_valid</span><span class="p">,</span> <span class="n">cycle_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">current_index</span> <span class="o">=</span> <span class="n">first_valid</span>
    <span class="k">while</span><span class="p">(</span><span class="n">first_valid</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">next_index</span> <span class="o">=</span> <span class="n">people_permutation</span><span class="p">[</span><span class="n">current_index</span><span class="p">]</span>
        <span class="n">people_permutation</span><span class="p">[</span><span class="n">current_index</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#-1 means done</span>
        
        
        <span class="k">if</span> <span class="n">people_permutation</span><span class="p">[</span><span class="n">next_index</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#now completely reset and append to seen cycle types</span>
            <span class="n">occurrences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cycle_type</span><span class="p">)</span>
            
            <span class="n">first_valid</span><span class="p">,</span> <span class="n">cycle_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">while</span><span class="p">(</span><span class="n">people_permutation</span><span class="p">[</span><span class="n">first_valid</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">first_valid</span> <span class="o">+=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">first_valid</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                    <span class="k">break</span>
            
            <span class="n">current_index</span> <span class="o">=</span> <span class="n">first_valid</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cycle_type</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="n">current_index</span> <span class="o">=</span> <span class="n">next_index</span>
                      
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
    
    

<span class="k">def</span> <span class="nf">create_random_cycle_type</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use the quick method to create cycle types</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cycle_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">total_elements_left</span> <span class="o">=</span> <span class="n">n</span>
    
    
    <span class="k">while</span><span class="p">(</span><span class="n">total_elements_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        
        <span class="c1">#each cycle type length is equally likely to be generated so just pick one at random</span>
        <span class="n">remove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">total_elements_left</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">cycle_type</span><span class="p">[</span><span class="n">remove</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">total_elements_left</span> <span class="o">-=</span> <span class="n">remove</span>
        
    <span class="c1">#remove duplicates</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cycle_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">simulate_and_count</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N_simulations</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="n">create_random_cycle_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the simulator a number of times and keeps track of how many times each cycle type appeared</span>
<span class="sd">    in the generated permutation. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">occurrences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_simulations</span><span class="p">):</span>
        <span class="n">cycle_type</span> <span class="o">=</span> <span class="n">simulator</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycle_type</span><span class="p">:</span>
            <span class="n">occurrences</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
            
    <span class="k">return</span> <span class="n">occurrences</span><span class="o">/</span><span class="n">N_simulations</span>
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
    </div>
    </div>
</div>
<div class="panel-right"></div>
</div>
</body>

 


</html>
